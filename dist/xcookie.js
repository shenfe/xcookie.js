!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.iframexcookie=n()}(this,function(){"use strict";function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var r in t)n[r]=t[r]}return n}function n(t){function r(n,o,i){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(i=e({path:"/"},r.defaults,i)).expires){var c=new Date;c.setMilliseconds(c.getMilliseconds()+864e5*i.expires),i.expires=c}i.expires=i.expires?i.expires.toUTCString():"";try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(g){}o=t.write?t.write(o,n):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=(n=(n=encodeURIComponent(String(n))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var d="";for(var s in i)i[s]&&(d+="; "+s,!0!==i[s]&&(d+="="+i[s]));return document.cookie=n+"="+o+d}n||(a={});for(var f=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,p=0;p<f.length;p++){var l=f[p].split("="),m=l.slice(1).join("=");'"'===m.charAt(0)&&(m=m.slice(1,-1));try{var v=l[0].replace(u,decodeURIComponent);if(m=t.read?t.read(m,v):t(m,v)||m.replace(u,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch(g){}if(n===v){a=m;break}n||(a[v]=m)}catch(g){}}return a}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(n,t){r(n,"",e(t,{expires:-1}))},r.withConverter=n,r}function t(e){var n=window.document.createElement("a");n.href=e;var t=n.hostname;if(/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(t))return t;var r=t.split(".");return r.length>2?"."+r.slice(r.length-2).join("."):r.join(".")}function r(e){window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent("onmessage",e)}function o(e){var n="";if("[object Array]"===Object.prototype.toString.call(e))for(var t=0,r=e.length;t<r;t++)0===t?n=encodeURIComponent(e[t]):n+="&"+encodeURIComponent(e[t]);else{t=0;for(var o in e)e.hasOwnProperty(o)&&(0===t?(t++,n=encodeURIComponent(o)):n+="&"+encodeURIComponent(o))}return n}var i=n(function(){}),a=function(){var e=0;return function(){return++e}}(),c={};return function(e){function n(e,n){var t="xcookie-"+e.replace(/\./g,"_"),r=window.document.getElementById(t);return r||((r=window.document.createElement("iframe")).id=t,r.style.display="none",window.document.body.appendChild(r)),n!==undefined?r.src=n:r.src="",r}function d(e){return"[object Array]"===Object.prototype.toString.call(f)?e:f[e]}var s=e.src,f=e.cookieNames,u=e.doneWith,p=a();u&&(c[p]=u);var l=t(s),m=t(window.location.href);n(l);r(function(e){var n="[iframexcookie:".length;if("[iframexcookie:"===e.data.substr(0,n)){var t=e.data.indexOf("]",n);if(t<0)return;var r=e.data.substring(n,t);try{var o=JSON.parse(e.data.substr(t+1));for(var a in o)o.hasOwnProperty(a)&&null!=o[a]&&(i.set(d(a),o[a],{expires:7,domain:m,path:"/"}),c[r]&&(c[r](o),delete c[r]))}catch(e){}}}),n(l,s+"?"+o(f)+"&iframexcookie_id="+p)}});
